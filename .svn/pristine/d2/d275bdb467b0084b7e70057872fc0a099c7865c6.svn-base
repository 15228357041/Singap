<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mingcloud.proxy.datalayer.dao.archiveinfo.InstrumentMapper">

	<sql id="table_name">
		instrument
	</sql>

	<sql id="table_id">
		id
	</sql>

	<!-- table columns -->
	<sql id="database_table_columns">
		 <include refid="table_name"/>.id, 
		 <include refid="table_name"/>.instrumentkey, 
		 <include refid="table_name"/>.instrumentname, 
		 <include refid="table_name"/>.unitid, 
		 <include refid="table_name"/>.baselinevalue, 
		 <include refid="table_name"/>.upperlimitvalue, 
		 <include refid="table_name"/>.lowerlimitvalue, 
    	 <include refid="table_name"/>.createdate, 
    	 <include refid="table_name"/>.createuserid, 
    	 <include refid="table_name"/>.modificationdate, 
    	 <include refid="table_name"/>.modificationuserid, 
    	 <include refid="table_name"/>.picpath, 
    	 <include refid="table_name"/>.barcode, 
    	 <include refid="table_name"/>.memo, 
    	 <include refid="table_name"/>.orgid, 
    	 <include refid="table_name"/>.accountid, 
    	 <include refid="table_name"/>.tombstone
	</sql>

	<sql id="releation_query_columns">

	</sql>
	
	<!-- 成本中心的关联信息 -->
	<sql id="releation_costcenter_table_name">
		costcenter
	</sql>

	<sql id="releation_costcenter_table_id">
		<include refid="releation_costcenter_table_name"/>.id
	</sql>
	
	<sql id="releation_costcenter_columns">
		<include refid="releation_costcenter_table_name"/>.costcentername
	</sql>
	
	<!-- 计量单位信息相关的表格、主键及列信息 ，用于计量单位名称信息的展示-->
	<sql id="releation_unit_table_name">
		unit
	</sql>
	<sql id="releation_unit_columns">
		<include refid="releation_unit_table_name"/>.unitname
	</sql>
	<sql id="releation_unit_table_id">
		<include refid="releation_unit_table_name"/>.id
	</sql>
	<insert id="insert" parameterType="com.mingcloud.proxy.datalayer.dto.archiveinfo.InstrumentDto"
		useGeneratedKeys="true" keyProperty="id">
		insert into
		<include refid="table_name" />
		(
			 instrumentkey, 
			 instrumentname, 
			 unitid, 
			 baselinevalue, 
			 upperlimitvalue, 
			 lowerlimitvalue, 
	    	 createdate, 
	    	 createuserid, 
	    	 picpath, 
	    	 barcode, 
	    	 memo, 
	    	 orgid, 
	    	 accountid, 
	    	 tombstone
		)
		values 
		(
			#{instrumentkey,jdbcType=VARCHAR}, 
			#{instrumentname,jdbcType=VARCHAR}, 
			#{unitid,jdbcType=INTEGER}, 
      		#{baselinevalue,jdbcType=DECIMAL}, 
      		#{upperlimitvalue,jdbcType=DECIMAL},
      		#{lowerlimitvalue,jdbcType=DECIMAL}, 
     		#{createdate,jdbcType=TIMESTAMP}, 
     		#{createuserid,jdbcType=INTEGER}, 
      		#{picpath,jdbcType=VARCHAR}, 
      		#{barcode,jdbcType=VARCHAR}, 
     		#{memo,jdbcType=VARCHAR}, 
     		#{orgid,jdbcType=INTEGER}, 
     		#{accountid,jdbcType=INTEGER}, 
      		#{tombstone,jdbcType=INTEGER}
      	)
	</insert>
	
    <update id="update" parameterType="com.mingcloud.proxy.datalayer.dto.archiveinfo.InstrumentDto">
		update
		<include refid="table_name" />
		<set>
			<if test="instrumentkey != null" >
	        	 instrumentkey = #{instrumentkey,jdbcType=VARCHAR},
	      	</if>
	      	<if test="instrumentname != null" >
	        	 instrumentname = #{instrumentname,jdbcType=VARCHAR},
	      	</if>
	      	<if test="unitid != null" >
	        	 unitid = #{unitid,jdbcType=INTEGER},
	      	</if>
	      	<if test="baselinevalue != null" >
	        	 baselinevalue = #{baselinevalue,jdbcType=DECIMAL},
	      	</if>
	      	<if test="upperlimitvalue != null" >
	        	 upperlimitvalue = #{upperlimitvalue,jdbcType=DECIMAL},
	      	</if>
	      	<if test="lowerlimitvalue != null" >
	        	 lowerlimitvalue = #{lowerlimitvalue,jdbcType=DECIMAL},
	      	</if>
	      	<if test="modificationdate != null" >
	        	 modificationdate = #{modificationdate,jdbcType=TIMESTAMP},
	      	</if>
	      	<if test="modificationuserid != null" >
	        	 modificationuserid = #{modificationuserid,jdbcType=INTEGER},
	      	</if>
	      	<if test="picpath != null" >
	        	 picpath = #{picpath,jdbcType=VARCHAR},
	      	</if>
	      	<if test="barcode != null" >
	        	 barcode = #{barcode,jdbcType=VARCHAR},
	      	</if>
	      	<if test="memo != null" >
	        	 memo = #{memo,jdbcType=VARCHAR},
	      	</if>
	      	<if test="orgid != null" >
	        	 orgid = #{orgid,jdbcType=INTEGER},
	      	</if>
	      	<if test="accountid != null" >
	        	 accountid = #{accountid,jdbcType=INTEGER},
	      	</if>
	      	<if test="tombstone != null" >
	        	 tombstone = #{tombstone,jdbcType=INTEGER}
	      	</if>  		
		</set>
		where
		<include refid="table_id" />
		= #{id,jdbcType=INTEGER}
	</update>


	<resultMap id="dtoBeanResult" type="com.mingcloud.proxy.datalayer.dto.archiveinfo.InstrumentDto">
		<id column="id" property="id" jdbcType="INTEGER" />
	    <result column="instrumentkey" property="instrumentkey" jdbcType="VARCHAR" />
	    <result column="instrumentname" property="instrumentname" jdbcType="VARCHAR" />
	    <result column="unitid" property="unitid" jdbcType="INTEGER" />
	    <result column="baselinevalue" property="baselinevalue" jdbcType="DECIMAL" />
	    <result column="upperlimitvalue" property="upperlimitvalue" jdbcType="DECIMAL" />
	    <result column="lowerlimitvalue" property="lowerlimitvalue" jdbcType="DECIMAL" />
	    <result column="createdate" property="createdate" jdbcType="TIMESTAMP" />
	    <result column="createuserid" property="createuserid" jdbcType="INTEGER" />
	    <result column="modificationdate" property="modificationdate" jdbcType="TIMESTAMP" />
	    <result column="modificationuserid" property="modificationuserid" jdbcType="INTEGER" />
	    <result column="picpath" property="picpath" jdbcType="VARCHAR" />
	    <result column="barcode" property="barcode" jdbcType="VARCHAR" />
	    <result column="memo" property="memo" jdbcType="VARCHAR" />
	    <result column="orgid" property="orgid" jdbcType="INTEGER" />
	    <result column="accountid" property="accountid" jdbcType="INTEGER" />
	    <result column="tombstone" property="tombstone" jdbcType="INTEGER" />		
	</resultMap>

	<select id="selectAll" resultMap="dtoBeanResult">
		SELECT
          INSTRUMENT_KEY as instrumentkey,INSTRUMENT_NAME as instrumentname
		FROM
		  INSTRUMENT
	</select>

    <select id="selectByInstrumentKey" parameterType="java.lang.String" resultMap="dtoBeanResult">
        SELECT
          <include refid="database_table_columns" />
        FROM
          <include refid="table_name" />
        WHERE <include refid="table_name" />.instrumentkey = #{instrumentkey, jdbcType=VARCHAR}
    </select>

	<select id="selectKeyIdMap" resultMap="dtoBeanResult">
		SELECT
			instrumentkey, id
		FROM
			<include refid="table_name" />
	</select>
</mapper>