<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingcloud.proxy.datalayer.dao.archiveinfo.UpdateStockRecordMapper" >
  	
	<sql id="table_name">
		updatestockrecord
	</sql>
	
	<sql id="table_id">
		<include refid="table_name"/>.id
	</sql>
	
  	<sql id="database_table_columns" >
		<include refid="table_name"/>.organizationkey,
		<include refid="table_name"/>.sparepartkey,
		<include refid="table_name"/>.checkuser,
		<include refid="table_name"/>.lifnr,
		<include refid="table_name"/>.sparepartname,
		<include refid="table_name"/>.stockkey,
		<include refid="table_name"/>.status,
		<include refid="table_name"/>.tombstone,
		<include refid="table_name"/>.createdate,
		<include refid="table_name"/>.createuserid,
		<include refid="table_name"/>.modificationdate,
		<include refid="table_name"/>.modificationuserid
  </sql>
 
 	<sql id="update_stock_record_where">
 		<trim prefix=""  suffix="" prefixOverrides=",">
 			<if test="organizationkey != null" >
				organizationkey = #{organizationkey,jdbcType=VARCHAR},
      		</if>
	      	<if test="sparepartkey != null" >
				sparepartkey = #{sparepartkey,jdbcType=VARCHAR},
	      	</if>
	      	<if test="checkuser != null" >
				checkuser = #{checkuser,jdbcType=VARCHAR},
	      	</if>
	      	<if test="lifnr != null" >
				lifnr = #{lifnr,jdbcType=VARCHAR},
	      	</if>
	      	<if test="sparepartname != null" >
				sparepartname = #{sparepartname,jdbcType=VARCHAR},
	      	</if>
	      	<if test="stockkey != null" >
				stockkey = #{stockkey,jdbcType=VARCHAR},
	      	</if>
			<if test="status != null" >
				status = #{status,jdbcType=INTEGER},
			</if>
	      	<if test="createdate != null" >
				createdate = #{createdate,jdbcType=TIMESTAMP},
	      	</if>
	      	<if test="createuserid != null" >
	        	createuserid = #{createuserid,jdbcType=INTEGER},
	      	</if>
	      	<if test="modificationdate != null" >
	        	modificationdate = #{modificationdate,jdbcType=TIMESTAMP},
	      	</if>
	      	<if test="modificationuserid != null" >
	        	modificationuserid = #{modificationuserid,jdbcType=INTEGER},
	      	</if>
	      	<if test="tombstone != null" >
	        	tombstone = #{tombstone,jdbcType=INTEGER},
	      	</if>
 		</trim>
 	</sql>
 
 	<sql id="dynamic_full_match_condition">
		<trim prefix="WHERE" prefixOverrides="AND" suffixOverrides=",">
			<if test="id != null">
				AND <include refid="table_name"/>.id = #{id,jdbcType=INTEGER}
			</if>
			<if test="organizationkey != null" >
				AND <include refid="table_name"/>.organizationkey = #{organizationkey,jdbcType=VARCHAR},
			</if>
			<if test="sparepartkey != null" >
				AND <include refid="table_name"/>.sparepartkey = #{sparepartkey,jdbcType=VARCHAR},
			</if>
			<if test="checkuser != null" >
				AND <include refid="table_name"/>.checkuser = #{checkuser,jdbcType=VARCHAR},
			</if>
			<if test="lifnr != null" >
				AND <include refid="table_name"/>.lifnr = #{lifnr,jdbcType=VARCHAR},
			</if>
			<if test="sparepartname != null" >
				AND <include refid="table_name"/>.sparepartname = #{sparepartname,jdbcType=VARCHAR},
			</if>
			<if test="stockkey != null" >
				AND <include refid="table_name"/>.stockkey = #{stockkey,jdbcType=VARCHAR},
			</if>
			<if test="status != null" >
				AND <include refid="table_name"/>.status = #{status,jdbcType=INTEGER},
			</if>
			<if test="createdate != null" >
				AND <include refid="table_name"/>.createdate = #{createdate,jdbcType=TIMESTAMP},
			</if>
			<if test="createuserid != null" >
				AND <include refid="table_name"/>.createuserid = #{createuserid,jdbcType=INTEGER},
			</if>
			<if test="modificationdate != null" >
				AND <include refid="table_name"/>.modificationdate = #{modificationdate,jdbcType=TIMESTAMP},
			</if>
			<if test="modificationuserid != null" >
				AND <include refid="table_name"/>.modificationuserid = #{modificationuserid,jdbcType=INTEGER},
			</if>
			<if test="tombstone != null" >
				AND <include refid="table_name"/>.tombstone = #{tombstone,jdbcType=INTEGER},
			</if>
     		 </trim>
     </sql>
 
 	<insert id="insert" parameterType="UpdateStockRecordEntity"
  		useGeneratedKeys="true" keyProperty="id" databaseId="mysql">
    	insert into 
    	<include refid="table_name"/>
    	(
		organizationkey,
		sparepartkey,
		checkuser,
		lifnr,
		sparepartname,
		stockkey,
		status,
		tombstone,
		createdate,
		createuserid,
		modificationdate,
		modificationuserid
		)
		values
		(
		 #{organizationkey,jdbcType=VARCHAR},
		 #{sparepartkey,jdbcType=VARCHAR},
		 #{checkuser,jdbcType=VARCHAR},
		 #{lifnr,jdbcType=VARCHAR},
		 #{sparepartname,jdbcType=VARCHAR},
		 #{stockkey,jdbcType=VARCHAR},
		 0,
		 1,
		 #{createdate,jdbcType=TIMESTAMP},
		 #{createuserid,jdbcType=INTEGER},
		 #{modificationdate,jdbcType=TIMESTAMP},
		 #{modificationuserid,jdbcType=INTEGER}
		)
  	</insert>

	<!-- 逻辑删除，为更新 -->
	<update id="delete" parameterType="UpdateStockRecordEntity">
	    update <include refid="table_name" />
	    <set>
	         tombstone =0
	    </set>
		<include refid="dynamic_full_match_condition"/>
	</update>

  	<update id="update" parameterType="UpdateStockRecordEntity" >
    	update 
    	<include refid="table_name"/>
    	<set >
      		<include refid="update_stock_record_where"/>
    	</set>
		where
    	<if test="id != null" >
        	id = #{id,jdbcType=INTEGER}
     	</if>

  	</update>


	<resultMap id="entityBeanResult" type="UpdateStockRecordEntity">
	    <id column="id" property="id" jdbcType="INTEGER" />
  	</resultMap>

	
	<select id="select" parameterType="UpdateStockRecordEntity" resultMap="entityBeanResult">
		SELECT
		<include refid="table_name"/>.id,
		sparepart.id as spid,
		stock.id as stockid,
		organization.id as orgid,
		stock.stockname as stockname,
		<include refid="database_table_columns" />
		FROM
		<include refid="table_name" />
		LEFT JOIN sparepart on sparepart.sparepartkey = <include refid="table_name"/>.sparepartkey
		LEFT JOIN stock on stock.stockkey = <include refid="table_name"/>.stockkey
		LEFT JOIN organization on organization.organizationkey = <include refid="table_name"/>.organizationkey
		<include refid="dynamic_full_match_condition" />
	</select>

	
	<select id="selectCount" parameterType="UpdateStockRecordEntity"
		resultType="int">
		SELECT COUNT(1)
		FROM
		<include refid="table_name" />
		<include refid="dynamic_full_match_condition" />
	</select>

	
</mapper>